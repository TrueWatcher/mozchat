<!DOCTYPE html>
<html lang="en">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>Multimedia chat</title>
  <link rel="stylesheet" type="text/css" href="" media="all" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.5" />
</head>
<body>
<p>Mozchat, an open source web phone and media chat by TrueWatcher 2019</p>

<h1>РУКОВОДСТВО ПОЛЬЗОВАТЕЛЯ</h1>

<h2>Требования</h2>

<p>FireFox 55+, Chrome 52+ десктоп или Android</p>
<p>Телефония по WebRTC вообще не отличается стабильностью, а у беспроводных провайдеров еще и работает только через TURN-сервер. Медиачат в режимах audioStream и особенно videoStream требуют быстрой сети и компьютера. Режим mediaChat (по умолчанию) как правило работает даже через GPRS/EDGE.</p>

<h2>Запуск</h2>

<p>На первом экране нужно ввести своё имя и название нити, нажать Register или Enter.</p>
<p>При нормальном ходе дел, при появлении второго экрана браузер спросит разрешение на использование микрофона. После подтверждения около середины страницы будет видна большая кнопка с надписью Record.</p>
<p>---------</p>
<!--<p>Если в данной нити включена аутентикация, для входа понадобится ещё и пароль.</p>-->
<p>Если что-то не так с браузером, например нет нужных функций (getUserMedia, PeerConnection), приложение не сможет нормально запуститься и кнопки Record не будет. Возможно, будет выдано сообщение о том, чего именно не хватает. Обновите браузер, это полезно и само по себе :).</p>
<p>При отказе на использование микрофона Рекордер работать не сможет, но Проигрыватель будет работоспособен. На кнопке будет написано Inactive, под ней будет сообщение об ошибке.</p>
<p>Некоторые браузеры (не самые новые) отказываются автоматически проигрывать получаемые сообщения, хотя нормально воспроизводят их кнопкой play. Проблема вызвана отключенным autoplay и лечится его включением в настройках. Современные браузеры догадывются включать autoplay после получения разрешения на использование микрофона.</p>

<h2>Использование с настройками по умолчанию</h2>

<p>Панель телефона/чата имеет вверху <b>список пользователей</b> в онлайне, как минимум там должно быть Ваше имя. Кликнув на нужное имя, Вы выбираете его в качестве адресата. Можно ввести его в поле <b>адресат</b> и вруную :)</p>

<p><b>Кнопки Call и HangUp</b> служат для звонка выбранному пользователю и для отмены звонка соответственно. Сейчас поддерживается только голосовая связь без видео, создающая трафик порядка 50-100kbps. Ниже видна "кнопка" состояния телефона, в режиме ожидания на ней должно быть написано ready, при удачно установившемся соединении - speak. Нажимать на неё не надо.</p>

<p>Поле <b>чат-сообщение</b> служит для ввода нового сообщения, которое будет отправлено выбранному адресату при нажатии Enter или <b>кнопки Send</b>. Под кнопкой Send находится строка сообщений сервера, ниже - окно чата, изначально пустое.</p>

<p>Ниже находятся панели записи и проигрывания, служащие для отправки и воспроизведения аудио/видео сообщений через сервер.</p>

<p>Кнопка <b>Record</b> включает/выключает запись. Так же действует нажатие/отпускание клавиши Пробел. По умолчанию записанное сообщение сразу отсылается на сервер всем активным пользователям.</p>

<p>Панель проигрывателя имеет наверху <b>список записей</b>, хранящихся на сервере (в дальнейшем - клипов), хотя он вполне может оказаться пустым.</p>

<p>При появлении на сервере новых клипов они автоматически воспроизводятся Проигрывателем, если их несколько - то последовательно.</p>

<p>Кнопка <b>Stop</b> останавливает воспроизведение, если оно происходит :). Так же действует клавиша Esc.</p>

<p>Кнопка <b>Standby</b> приостанавливает Проигрыватель, приходящие клипы будут просто добавляться в список. При повторном нажатии запустится воспроизведение с места остановки или с первого добавившегося клипа.</p>

<p><b>Кнопки E</b> открывают/скрывают полный вид панелей с настройками и дополнительной информацией.</p>

<p></p>

<h2>Настройки Телефона/чата</h2>

<p><b>answer immediately</b><br /> старается установить соединение сразу при получении вызова (FireFox все равно спросит разрешение на использование микрофона, Chrome - нет) Если снять галочку - программа будет всегда сама спрашивать подтверждение.</p>

<p><b>ring</b><br /> подавать звуковой сигнал вызова.</p>

<p>Если адресат чат-сообщения недоступен, сообщение хранится на сервере некоторое время (по умолчанию 5 мин) и будет ему доставлено, если он войдет в систему.</p>

<h2>Настройки Рекордера</h2>

<p><b>server limits</b><br />
  полезный параметр lifetime - срок хранения клипа на сервере</p>

<p><b>audio./video</b><br />
  записывать аудио или видео, при переключении браузер спросит разрешение заново. Видео сильно жрёт трафик. Если эти кнопки не видны - в данной нити доступно только аудио.</p>

<p><b>upload/stop</b><br /> 
  upload отправляет новозаписанный кусок на сервер и продолжает запись<br /><br />
  
  stop останавливает запись и показывает кнопки Play, Upload и ссылку The File. Кликнув ссылку правой кнопкой мыши, можно сохранить запись в файл. Для отправки на сервер нужно нажать Upload. Если размер клипа оказался больше максимума (server limits - clip), приложение откажется его загружать<br /><br />
  
  если эти настройки не видны - в данной нити действует stop</p>

<p><b>chunk</b><br />
  размер кусочка в секундах до срабатывания upload/stop</p>

<p><b>description</b><br />
  появится в списке как заголовок клипа</p>

<p><b>pause player</b><br />
  приостанавливает Проигрыватель, когда включена запись. Можете отключить, если у Вас есть наушники и способность говорить и слушать одновременно

<h2>Настройки и параметры Проигрывателя</h2>

<p><b>кнопки в списке клипов</b><br />
  <b>delete</b> можно удалять свои клипы, чужие нельзя<br />
  <b>play</b> проиграть только этот клип<br />
  <b>play from</b> проигрывать этот клип и следующие, действует ограничение skip mine (см. ниже), выводит из режима standby</p>

<p><b>Stop After</b><br />
  остановить проигрывание, доиграв проигрываемый клип до конца</p>

<p><b>refresh</b><br />
  интервал опроса сервера (секунды), long - использовать long polling, off - отключить совсем. Игнорируется, если задействован сервер Websockets.</p>

<p><b>free</b><br />
  свободное место на сервере, нужно для отладки</p>

<p><b>play new</b><br />
  автоматически проигрывать новые клипы, нужно для отладки</p>

<p><b>skip mine</b><br />
  не проигрывать свои клипы. Самый простой и действенный тест системы - снять эту галочку и записать что-нибудь.</p>

<p></p>
  
<h2>Ещё</h2>

<p><a href="https://github.com/TrueWatcher/mozchat/blob/master/README.md">https://github.com/TrueWatcher/mozchat/blob/master/README.md</a></p>

</body>
</html>
